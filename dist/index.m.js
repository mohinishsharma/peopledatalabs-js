import e from"axios";import t from"lodash";function n(){return n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},n.apply(this,arguments)}var i=function(e,t,n,i,a){return new Promise(function(s,r){var o={};if(e||(o.message="Missing "+(i||"Params"),o.status=400,r(o)),"search"===a&&(e.searchQuery||(o.message="Missing searchQuery",o.status=400,r(o))),"retrieve"===a&&(e.id||(o.message="Missing id",o.status=400,r(o))),"autocomplete"===a){var c=e.field,u=["company","country","industry","location","major","region","role","school","sub_role","skill","title"];c?-1===u.indexOf(c)&&(o.message="field should be one of: "+u,o.status=400,r(o)):(o.message="Missing field",o.status=400,r(o))}"jobTitle"===a&&(e.jobTitle||(o.message="Missing jobTitle",o.status=400,r(o))),"skill"===a&&(e.skill||(o.message="Missing skill",o.status=400,r(o))),t||(o.message="Missing API Base Path",o.status=400,r(o)),(!n||n.length>=36)&&(o.message="Invalid API Key",o.status=401,r(o)),s()})},a=function(e){var t={400:"Request contained either missing or invalid parameters",401:"Request contained a missing or invalid key",402:"Payment Required, You have hit your account maximum (all matches used)",404:"No records were found matching your request",405:"Request method is not allowed on the requested resource",429:"An error occurred due to requests hitting the API too quick",500:"The server encountered an unexpected condition which prevented it from fulfilling the request"};if(e.response){var n=e.response.status,i=n>=500&&n<600?500:n;return{status:i,message:t[i]}}return{status:500,message:t[500]}},s=function(e){var t={rateLimitRemaining:e.headers["x-ratelimit-remaining"]?JSON.parse(e.headers["x-ratelimit-remaining"].replace(/'/g,'"')):void 0,rateLimitReset:e.headers["x-ratelimit-reset"]||void 0,rateLimitLimit:e.headers["x-ratelimit-limit"]?JSON.parse(e.headers["x-ratelimit-limit"].replace(/'/g,'"')):void 0,totalLimitOveragesRemaining:e.headers["x-totallimit-overages-remaining"]?Number(e.headers["x-totallimit-overages-remaining"]):void 0,totalLimitPurchasedRemaining:e.headers["x-totallimit-purchased-remaining"]?Number(e.headers["x-totallimit-purchased-remaining"]):void 0,totalLimitRemaining:e.headers["x-totallimit-remaining"]?Number(e.headers["x-totallimit-remaining"]):void 0,callCreditsType:e.headers["x-call-credits-type"]||void 0,callCreditsSpent:e.headers["x-call-credits-spent"]?Number(e.headers["x-call-credits-spent"]):void 0,lifetimeUsed:e.headers["x-lifetime-used"]?Number(e.headers["x-lifetime-used"]):void 0};return Array.isArray(e.data)?{items:e.data,rateLimit:t}:n({},e.data,{rateLimit:t})},r=function(t,r,o,c){return new Promise(function(u,l){i(o,t,r,null,"cleaner").then(function(){e.get(t+"/"+c+"/clean",{params:n({api_key:r},o),headers:{"Accept-Encoding":"gzip","User-Agent":"PDL-JS-SDK"}}).then(function(e){var t;200===(null==e||null==(t=e.data)?void 0:t.status)&&u(s(e))}).catch(function(e){l(a(e))})}).catch(function(e){l(e)})})},o=function(n,r,o,c,u){return new Promise(function(l,h){i(c,n,o,null,"enrichment").then(function(){var i=c.sandbox&&"person"===u?r+"/"+u+"/enrich":n+"/"+u+"/enrich",d=t.cloneDeep(c),p=new URLSearchParams;delete d.sandbox,Object.entries(d).forEach(function(e){var t=e[0],n=e[1];"profile"===t?Array.isArray(n)?p.append(t,JSON.stringify(n)):p.append(t,n):"object"==typeof n?Array.isArray(n)?n.forEach(function(e){p.append(t,e)}):p.append(t,JSON.stringify(n)):p.append(t,n)}),p.append("api_key",o),e.get(i,{params:p,headers:{"Accept-Encoding":"gzip","User-Agent":"PDL-JS-SDK"}}).then(function(e){var t;200===(null==e||null==(t=e.data)?void 0:t.status)&&l(s(e))}).catch(function(e){h(a(e))})}).catch(function(e){h(e)})})},c=function(t,n,r,o,c,u){return new Promise(function(l,h){i(c,t,r,null,"search").then(function(){var i,d=c.pretty,p=c.sandbox,f=((i={titlecase:c.titlecase||!1,dataset:c.dataset||"all",scroll_token:c.scroll_token||null,size:c.size||10})["sql"===o?"sql":"query"]=c.searchQuery,i.pretty=d||!1,i);e.post(p&&"person"===u?n+"/person/search":t+"/"+u+"/search",f,{headers:{"Content-Type":"application/json","Accept-Encoding":"gzip","X-Api-Key":r,"User-Agent":"PDL-JS-SDK"}}).then(function(e){var t;200===(null==e||null==(t=e.data)?void 0:t.status)&&l(s(e))}).catch(function(e){h(a(e))})}).catch(function(e){h(e)})})},u=function(u){var l=this,h=u.apiKey,d=u.basePath,p=u.sandboxBasePath,f=u.version;this.apiKey=void 0,this.basePath=void 0,this.sandboxBasePath=void 0,this.person=void 0,this.company=void 0,this.school=void 0,this.location=void 0,this.autocomplete=void 0,this.skill=void 0,this.jobTitle=void 0,this.apiKey=h,this.basePath=d||"https://api.peopledatalabs.com/"+(f||"v5"),this.sandboxBasePath=p||"https://sandbox.api.peopledatalabs.com/"+(f||"v5"),this.person={enrichment:function(e){return o(l.basePath,l.sandboxBasePath,l.apiKey,e,"person")},search:{elastic:function(e){return c(l.basePath,l.sandboxBasePath,l.apiKey,"elastic",e,"person")},sql:function(e){return c(l.basePath,l.sandboxBasePath,l.apiKey,"sql",e,"person")}},bulk:function(t){return function(t,n,r){var o={"Content-Type":"application/json","Accept-Encoding":"gzip","X-Api-Key":n,"User-Agent":"PDL-JS-SDK"};return new Promise(function(c,u){i(r,t,n,"Records","bulk").then(function(){e.post(t+"/person/bulk",r,{headers:o}).then(function(e){c(s(e))}).catch(function(e){u(a(e))})}).catch(function(e){u(e)})})}(l.basePath,l.apiKey,t)},identify:function(n){return function(n,r,o,c){return new Promise(function(u,l){i(c,n,o,null,"identify").then(function(){var i=c.sandbox?r+"/person/identify":n+"/person/identify",h=t.cloneDeep(c),d=new URLSearchParams;delete h.sandbox,Object.entries(h).forEach(function(e){var t=e[0],n=e[1];"profile"===t?Array.isArray(n)?d.append(t,JSON.stringify(n)):d.append(t,n):"object"==typeof n?Array.isArray(n)?n.forEach(function(e){d.append(t,e)}):d.append(t,JSON.stringify(n)):d.append(t,n)}),d.append("api_key",o),e.get(i,{params:d,headers:{"Accept-Encoding":"gzip","User-Agent":"PDL-JS-SDK"}}).then(function(e){var t;200===(null==e||null==(t=e.data)?void 0:t.status)&&u(s(e))}).catch(function(e){l(a(e))})}).catch(function(e){l(e)})})}(l.basePath,l.sandboxBasePath,l.apiKey,n)},retrieve:function(t){return function(t,r,o){return new Promise(function(c,u){i(o,t,r,"ID","retrieve").then(function(){e.get(t+"/person/retrieve/"+o.id,{params:n({api_key:r},o),headers:{"Accept-Encoding":"gzip","User-Agent":"PDL-JS-SDK"}}).then(function(e){var t;200===(null==e||null==(t=e.data)?void 0:t.status)&&c(s(e))}).catch(function(e){u(a(e))})}).catch(function(e){u(e)})})}(l.basePath,l.apiKey,t)}},this.company={enrichment:function(e){return o(l.basePath,l.sandboxBasePath,l.apiKey,e,"company")},search:{elastic:function(e){return c(l.basePath,l.sandboxBasePath,l.apiKey,"elastic",e,"company")},sql:function(e){return c(l.basePath,l.sandboxBasePath,l.apiKey,"sql",e,"company")}},cleaner:function(e){return r(l.basePath,l.apiKey,e,"company")}},this.school={cleaner:function(e){return r(l.basePath,l.apiKey,e,"school")}},this.location={cleaner:function(e){return r(l.basePath,l.apiKey,e,"location")}},this.autocomplete=function(t){return function(t,r,o){return new Promise(function(c,u){i(o,t,r,null,"autocomplete").then(function(){e.get(t+"/autocomplete",{params:n({api_key:r},{field:o.field,text:o.text||"",size:o.size||10,pretty:o.pretty||!1}),headers:{"Accept-Encoding":"gzip","User-Agent":"PDL-JS-SDK"}}).then(function(e){var t;200===(null==e||null==(t=e.data)?void 0:t.status)&&c(s(e))}).catch(function(e){u(a(e))})}).catch(function(e){u(e)})})}(l.basePath,l.apiKey,t)},this.jobTitle=function(t){return function(t,r,o){return new Promise(function(c,u){i(o,t,r,null,"jobTitle").then(function(){e.get(t+"/job_title/enrich",{params:n({api_key:r},{job_title:o.jobTitle,pretty:o.pretty||!1}),headers:{"Accept-Encoding":"gzip","User-Agent":"PDL-JS-SDK"}}).then(function(e){var t;200===(null==e||null==(t=e.data)?void 0:t.status)&&c(s(e))}).catch(function(e){u(a(e))})}).catch(function(e){u(e)})})}(l.basePath,l.apiKey,t)},this.skill=function(t){return function(t,r,o){return new Promise(function(c,u){i(o,t,r,null,"skill").then(function(){e.get(t+"/skill/enrich",{params:n({api_key:r},{skill:o.skill,pretty:o.pretty||!1}),headers:{"Accept-Encoding":"gzip","User-Agent":"PDL-JS-SDK"}}).then(function(e){var t;200===(null==e||null==(t=e.data)?void 0:t.status)&&c(s(e))}).catch(function(e){u(a(e))})}).catch(function(e){u(e)})})}(l.basePath,l.apiKey,t)}};export{u as default};
//# sourceMappingURL=index.m.js.map
